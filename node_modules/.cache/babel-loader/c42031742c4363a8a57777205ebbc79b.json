{"ast":null,"code":"var _jsxFileName = \"/Users/rines/Development/code/mod5/Telemed/Telemed-front/src/components/ConversationsList.js\";\nimport React from 'react';\nimport { ActionCable } from 'react-actioncable-provider';\nAPI_;\nimport NewConversationForm from './NewConversationForm';\nimport MessagesArea from './MessagesArea';\nimport Cable from './Cable';\n\nclass ConversationsList extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      conversations: [],\n      activeConversation: null\n    };\n\n    this.componentDidMount = () => {\n      fetch(`${API_ROOT}/conversations`).then(res => res.json()).then(conversations => this.setState({\n        conversations\n      }));\n    };\n\n    this.handleClick = id => {\n      this.setState({\n        activeConversation: id\n      });\n    };\n\n    this.handleReceivedConversation = response => {\n      const {\n        conversation\n      } = response;\n      this.setState({\n        conversations: [...this.state.conversations, conversation]\n      });\n    };\n\n    this.handleReceivedMessage = response => {\n      const {\n        message\n      } = response;\n      const conversations = [...this.state.conversations];\n      const conversation = conversations.find(conversation => conversation.id === message.conversation_id);\n      conversation.messages = [...conversation.messages, message];\n      this.setState({\n        conversations\n      });\n    };\n\n    this.render = () => {\n      const {\n        conversations,\n        activeConversation\n      } = this.state;\n      return React.createElement(\"div\", {\n        className: \"conversationsList\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      }, React.createElement(ActionCable, {\n        channel: {\n          channel: 'ConversationsChannel'\n        },\n        onReceived: this.handleReceivedConversation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46\n        },\n        __self: this\n      }), this.state.conversations.length ? React.createElement(Cable, {\n        conversations: conversations,\n        handleReceivedMessage: this.handleReceivedMessage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }) : null, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }, \"Conversations\"), React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      }, mapConversations(conversations, this.handleClick)), React.createElement(NewConversationForm, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }), activeConversation ? React.createElement(MessagesArea, {\n        conversation: findActiveConversation(conversations, activeConversation),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }) : null);\n    };\n  }\n\n}\n\nexport default ConversationsList; // helpers\n\nconst findActiveConversation = (conversations, activeConversation) => {\n  return conversations.find(conversation => conversation.id === activeConversation);\n};\n\nconst mapConversations = (conversations, handleClick) => {\n  return conversations.map(conversation => {\n    return React.createElement(\"li\", {\n      key: conversation.id,\n      onClick: () => handleClick(conversation.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, conversation.title);\n  });\n};","map":{"version":3,"sources":["/Users/rines/Development/code/mod5/Telemed/Telemed-front/src/components/ConversationsList.js"],"names":["React","ActionCable","API_","NewConversationForm","MessagesArea","Cable","ConversationsList","Component","state","conversations","activeConversation","componentDidMount","fetch","API_ROOT","then","res","json","setState","handleClick","id","handleReceivedConversation","response","conversation","handleReceivedMessage","message","find","conversation_id","messages","render","channel","length","mapConversations","findActiveConversation","map","title"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { ActionCable } from 'react-actioncable-provider';\n\nAPI_\nimport NewConversationForm from './NewConversationForm';\nimport MessagesArea from './MessagesArea';\nimport Cable from './Cable';\n\nclass ConversationsList extends React.Component {\n  state = {\n    conversations: [],\n    activeConversation: null,\n  };\n\n  componentDidMount = () => {\n    fetch(`${API_ROOT}/conversations`)\n      .then((res) => res.json())\n      .then((conversations) => this.setState({ conversations }));\n  };\n\n  handleClick = (id) => {\n    this.setState({ activeConversation: id });\n  };\n\n  handleReceivedConversation = (response) => {\n    const { conversation } = response;\n    this.setState({\n      conversations: [...this.state.conversations, conversation],\n    });\n  };\n\n  handleReceivedMessage = (response) => {\n    const { message } = response;\n    const conversations = [...this.state.conversations];\n    const conversation = conversations.find(\n      (conversation) => conversation.id === message.conversation_id\n    );\n    conversation.messages = [...conversation.messages, message];\n    this.setState({ conversations });\n  };\n\n  render = () => {\n    const { conversations, activeConversation } = this.state;\n    return (\n      <div className='conversationsList'>\n        <ActionCable\n          channel={{ channel: 'ConversationsChannel' }}\n          onReceived={this.handleReceivedConversation}\n        />\n        {this.state.conversations.length ? (\n          <Cable\n            conversations={conversations}\n            handleReceivedMessage={this.handleReceivedMessage}\n          />\n        ) : null}\n        <h2>Conversations</h2>\n        <ul>{mapConversations(conversations, this.handleClick)}</ul>\n        <NewConversationForm />\n        {activeConversation ? (\n          <MessagesArea\n            conversation={findActiveConversation(\n              conversations,\n              activeConversation\n            )}\n          />\n        ) : null}\n      </div>\n    );\n  };\n}\n\nexport default ConversationsList;\n\n// helpers\n\nconst findActiveConversation = (conversations, activeConversation) => {\n  return conversations.find(\n    (conversation) => conversation.id === activeConversation\n  );\n};\n\nconst mapConversations = (conversations, handleClick) => {\n  return conversations.map((conversation) => {\n    return (\n      <li key={conversation.id} onClick={() => handleClick(conversation.id)}>\n        {conversation.title}\n      </li>\n    );\n  });\n};\n"]},"metadata":{},"sourceType":"module"}